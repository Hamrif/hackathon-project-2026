<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ingredients - What the fridge?</title>
    <link rel="stylesheet" href="/style.css"> </head>
<body>
    <div class="main-container">
        <h1>Your Ingredients</h1>

        <div class="upload-section">
            <h3>1. Scan your fridge</h3>
            <form action="/analyze-image" method="POST" enctype="multipart/form-data">
                <input type="file" name="image" accept="image/*" required />
                <button type="submit">Analyze</button>
            </form>
        </div>

        <hr>

        <div class="manual-section">
            <h3>2. Or add manually</h3>
            <div class="input-group">
                <input type="text" id="ingredientInput" placeholder="e.g., Tomato, Chicken, Garlic...">
                <button type="button" id="addBtn">Add</button>
            </div>
        </div>

        <div class="list-section">
            <h3>Currently in your fridge:</h3>
            <ul id="ingredientList">
                <% if (typeof ingredients !== 'undefined' && ingredients.length > 0) { %>
                    <% ingredients.forEach(function(item) { %>
                        <li><%= item %> <button class="remove-btn">x</button></li>
                    <% }); %>
                <% } %>
            </ul>
        </div>
        
    </div>

    <script>
        const input = document.getElementById('ingredientInput');
        const addBtn = document.getElementById('addBtn');
        const list = document.getElementById('ingredientList');

        // Function to add a new ingredient manually
        addBtn.addEventListener('click', () => {
            const value = input.value.trim();
            if (value !== "") {
                addIngredient(value);
                input.value = ''; // Clear the input box
            }
        });

        // Allow pressing "Enter" to add an ingredient
        input.addEventListener('keypress', function (e) {
            if (e.key === 'Enter') {
                addBtn.click();
            }
        });

        // Helper function to create the list item and its remove button
        function addIngredient(name) {
            const li = document.createElement('li');
            li.textContent = name + " ";
            
            const removeBtn = document.createElement('button');
            removeBtn.textContent = 'x';
            removeBtn.className = 'remove-btn';
            
            // Remove the item when 'x' is clicked
            removeBtn.onclick = function() {
                li.remove();
            };

            li.appendChild(removeBtn);
            list.appendChild(li);
        }

        // Attach event listeners to any remove buttons rendered by the server
        document.querySelectorAll('.remove-btn').forEach(button => {
            button.onclick = function() {
                this.parentElement.remove();
            };
        });
    </script>
</body>
</html>